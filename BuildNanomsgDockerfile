FROM alpine:3.6
RUN set -ex \
    && apk add --no-cache gnupg libressl tar ca-certificates\
    \
    && wget https://github.com/nanomsg/nanomsg/archive/1.0.0.tar.gz \
    && tar xvf 1.0.0.tar.gz \
    && cd nanomsg-1.0.0 \
    && apk add --no-cache cmake gcc make libc-dev coreutils \
    && cmake -DCMAKE_INSTALL_PREFIX:PATH=/usr . \
    && make \
    && make install
RUN mkdir artifacts
RUN cp -r --parents /usr/include/nanomsg/ artifacts \
    && cp --parents /usr/bin/nanocat artifacts \
    && cp --parents /usr/lib64/pkgconfig/nanomsg.pc artifacts \
    && cp --parents /usr/lib64/libnanomsg* artifacts 
